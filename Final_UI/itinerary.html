<html>
<head>
<meta charset="utf-8">
<title>RoadRadar - Explore</title>
  <!-- <title>Eventloot</title> -->
  <meta name="description" content="">
  <!-- <link rel="shortcut icon" href="../images/favicon.ico"> -->
  <meta name="viewport" content="width=device-width">
<!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="bower_components/bootstrap/bootstrap.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<!-- Optional theme -->
<script src="bower_components/jquery/jquery.js"></script>
  <script src="bower_components/bootstrap/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<!-- Latest compiled and minified JavaScript -->
 <link rel="stylesheet" type="text/css" href="css/style.css">
 <style type="text/css">
   .info {
    position: relative;
    display: inline-block;
    color: #000;
    /*border-bottom: 1px dotted black;*/
}

.info a {
    color: #000;
    font-size: 15px;
    font-weight: 600;
    /*border-bottom: 1px dotted black;*/
}

/*.info .info-text {
    visibility: hidden;
    width: 300px;
    background-color: #3A3531;
    color: #fff;
    text-align: center;
    border-radius: 8px;
    padding: 5px 0;
    position: absolute;
    z-index: 1;
    top: 100%;
    left: 50%;
    margin-left: -150px;
}

.info:hover .info-text {
    visibility: visible;
}*/

 </style>
</head>
<body>
  <header>
   <!-- header start-->
    <div class="container-fluid">
      <div class="row">
        <nav class="navbar no-margin no-border">
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
             <!-- <div class="container nopadding"> -->
            <!-- Brand and toggle get grouped for better mobile display -->
            <!-- <div class="navbar-header"> -->
              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 logo-div">
                <a class="navbar-brand" href="index.html"><img src="images/logo.png"></a>
              </div>
            <!-- </div> -->
            <div class="col-lg-8 col-md-8 col-sm-8col-xs-8 menu-div">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="explore.html">EXPLORE</a></li>
                <li><a href="itinerary.html" class="active">ITINERARY</a></li>
                <li><a href="report.html">REPORT ISSUE</a></li>
                <li><a href="contact-us.html">ABOUT US</a></li>
              </ul>
              <!-- Collect the nav links, forms, and other content for toggling -->
            </div>
          </div>
        </nav>
      </div>
    </div>  <!-- /.container-fluid -->
  </header> <!-- header ends -->

<!-- Banner Part Start -->
  <section class="iti-banner-section no-padding no-margin no-border"> 
    <div class="container-fluid">
      <div class="row">
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 iti-baner">
              <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 iti-banner-div">
                    <h1>Search Itinerary</h1>
                      <input type="text" class="form-control" placeholder="Your Starting Point" id="start">
                      <input type="text" class="form-control" placeholder="Your Destination" id="dest">
                      <button type="button" class="btn btn-default" onclick="InitializeService()"></button>
                <!-- <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 iti-banner-div">
                      <input type="text" class="form-control" placeholder="Your Destination" id="dest">
                </div> -->
                <!-- <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 iti-banner-div">
                </div> -->
                <div class="route-div">
                <h1>Route Option</h1>
                <div class="your-result"><strong>YOUR RESULTS:</strong></div> 
                <!-- <div id="output" class="col-lg-offset-4 col-lg-4 col-md-offset-4 col-md-4 col-sm-offset-3 col-sm-4 col-xs-offset-2 col-xs-3 route-option-div"> -->
                <div id="output" class="col-lg-offset-1 col-lg-10 col-md-offset-1 col-md-10 col-sm-12 col-xs-12 route-option-div">
                <i class="fa fa-spin fa-2x" id="loader"></i>
                  <div class="distance"><p></p></div>
                  <div class="time"><p></p></div>
                  <div class="road-condition"><p></p></div>
                  </div>
                </div>
              </div>
              <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12 iti-map-div">
                <div id="map" style="height: 500px;"></div>
              </div>
          </div>
        </div>
    </div>
  </section>
<!-- Banner Part Ends -->
<!-- <section class="iti-map-section no-padding no-margin no-border"> 
    <div class="container-fluid">
      <div class="row">
        
      </div>
    </div>
  </section> -->
<!-- Route part focus Start -->



<!-- <section class="route-section no-padding no-margin no-border">
  <div class="container">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 route-div">
          <h1>Route Option</h1>
          <div class="your-result"><strong>YOUR RESULTS:</strong></div> 
          <div id="output" class="col-lg-offset-4 col-lg-4 col-md-offset-4 col-md-4 col-sm-offset-3 col-sm-4 col-xs-offset-2 col-xs-3 route-option-div">
            <div class="distance"><p></p></div>
            <div class="time"><p></p></div>
            <div class="road-condition"><p></p></div>
            </div>
          </div>
        </div>
      </div>
</section>
 -->


<!-- Route part focus Ends -->

<!-- Rights Part Ends -->
<section class="rights-section no-padding no-border">
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 rights-div">
        <h4>All Rights Reserved - ROADRADAR</h4>
        </div>
      </div>
    </div>
</section>
<!-- Rights Part Ends -->

 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC8_Lkt5jSWuogp6GB4IKivTDBzVhVmf8Y&libraries=places&callback=initAutocomplete"
         async defer></script>

<script type="text/javascript">
  // var start=document.getElementById('start').value;
  // var dest=document.getElementById('dest').value;
  // var url= "http://118.138.191.9:8080/roadDB/webresources/entities.roadsegment/getRoadCondition/"+ start + "/"+ dest
  // console.log (url);
  // -37.80978395301097, 144.96511459350586
  var map;
  function initAutocomplete() {
    // Create the autocomplete object, restricting the search to geographical
    // location types.
    map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: -37.80978395301097, lng: 144.96511459350586},
          zoom: 7
        });
    autocompleteStart = new google.maps.places.Autocomplete(
        /** @type {!HTMLInputElement} */(document.getElementById('start')),
        {types: ['geocode'],
        componentRestrictions: {country:"AU"}
      });
    autocompleteEnd = new google.maps.places.Autocomplete(
        /** @type {!HTMLInputElement} */(document.getElementById('dest')),
        {types: ['geocode'],
        componentRestrictions: {country:"AU"}
      });

    // When the user selects an address from the dropdown, populate the address
    // fields in the form.
    // autocompleteStart.addListener('place_changed', fillInAddress);
    // autocompleteEnd.addListener('place_changed', fillInAddress);
  }

  function InitializeService(){
    $('#loader').addClass('fa-spinner');
    var start = document.getElementById('start').value;
    var dest = document.getElementById('dest').value;
    console.log (start);
    console.log (dest);
  //    var url= "http://118.138.191.9:8080/roadDB/webresources/entities.roadsegment/getRoadCondition/"+ start + "/"+ dest
  // console.log (url);

// $.getJSON("http://118.138.191.9:8080/roadDB/webresources/entities.roadsegment/getRoadCondition/South Yarra, Victoria 3141/Caulfield Station, Victoria 3162",
//         function(data) { 101.188.23.46:1111
//            console.log (data);
//          });}
     $.getJSON("http://120.146.26.90:1111/roadRadarGithub/webresources/entities.roadsegment/getRoadCondition/"+ start + "/"+ dest, 
        function(data) {
          console.log (data.distance);
          console.log (data);
          var htmlText = '';
                htmlText += '<div class="distance">';
                htmlText += '<p class="p" style="margin-right: 10px; font-weight: 700;" > Distance: ' + data.distance + '</p>';
                htmlText += '</div>';
                // htmlText += '</div>';
                htmlText += '<div class="time">';
                htmlText += '<p class="p" style="margin-left: 10px; font-weight: 700;"> Duration: ' + data.duration + '</p>';
                htmlText += '</div>';
                htmlText += '<div class="road-condition">';
                htmlText += '<p class="p" style="margin-left: 10px; font-weight: 700;"> Road Rating: ' + data.roadCondition + ' out of 10 </p>';
                htmlText += '</div>';
                htmlText += '<div class="road-description">';
                htmlText += '<p class="p" style="margin-left: 10px; font-weight: 700;"> Road Status: ' + data.road_des + '</p>';
                htmlText += '</div>';
                // htmlText += '<i class="fa fa-info-circle" aria-hidden="true"></i> <span class="info">Info</span>'
                // htmlText += '<div class="map-button">';
                htmlText += '<div class="info"> <a " href="contact-us.html"<i class="fa fa-info-circle"></i>Info</a>';
                htmlText += '</div>';
                // htmlText += '<a style="margin-bottom: 10px;border: 0px;font-weight: 700; background-color:#ffffff;" href="" class="btn btn-default tooltip" role="button"><i class="fa fa-info-circle" aria-hidden="true"></i>Info  <span class="tooltiptext">The Safety Index is used to express the pavement condition of the itinerary. It is obtained  using the data provided by VicRoads. To check the original dataset click here. </p></a>'
                // htmlText += '<div class=info-text> <p>The Safety Index is used to express the pavement condition of the itinerary. It is obtained  using the data provided by VicRoads. To check the original dataset click here. </p> </div>'
                // htmlText +='<button type="info" <i class="fa fa-info-circle" aria-hidden="true"></i>Info</button>'
                // htmlText += '<input onClick="window.open(https://www.google.com/maps/dir/?api=1&destination='+ start + ',' + dest + ');" value="Take me there!" type="button" style="float: center; font-size: medium; color:#ffd200; background-color:#000000; border-color:#ffd200; border-radius: 5px;">'
                // htmlText += '</div>';
            // }

            $('#output').empty().append(htmlText);
            callmap(start,dest);
        })}

     function callmap(start,dest) {
        var directionsService = new google.maps.DirectionsService;
        var directionsDisplay = new google.maps.DirectionsRenderer;
        // var map = new google.maps.Map(document.getElementById('map'), {
        //   zoom: 7,
        //   center: {lat:-37.80978395301097, lng: 144.96511459350586}
        // });
        initAutocomplete();
        directionsDisplay.setMap(map);

        var onChangeHandler = function() {
          calculateAndDisplayRoute(directionsService, directionsDisplay);
        };
        document.getElementById('start').addEventListener('change', onChangeHandler());
        document.getElementById('dest').addEventListener('change', onChangeHandler());
      }

      function calculateAndDisplayRoute(directionsService, directionsDisplay) {
        directionsService.route({
          origin: document.getElementById('start').value,
          destination: document.getElementById('dest').value,
          travelMode: 'DRIVING'
        }, function(response, status) {
          if (status === 'OK') {
            directionsDisplay.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
      }

     </script>
    
  </body>
  </html>
